(window.webpackJsonp=window.webpackJsonp||[]).push([[39],{456:function(s,a,t){"use strict";t.r(a);var n=t(1),e=Object(n.a)({},(function(){var s=this,a=s._self._c;return a("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[a("h3",{attrs:{id:"_1、dns-缓存"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1、dns-缓存"}},[s._v("#")]),s._v(" 1、DNS 缓存")]),s._v(" "),a("div",{staticClass:"language-js line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token constant"}},[s._v("DNS")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" Domain Name System 域名系统\n"),a("span",{pre:!0,attrs:{class:"token constant"}},[s._v("DNS")]),s._v("解析： 通过域名找到对应的"),a("span",{pre:!0,attrs:{class:"token constant"}},[s._v("IP")]),s._v("地址\n"),a("span",{pre:!0,attrs:{class:"token constant"}},[s._v("DNS")]),s._v("缓存：浏览器，主机（操作系统），本地"),a("span",{pre:!0,attrs:{class:"token constant"}},[s._v("DNS")]),s._v("服务器，根域名服务器都会对"),a("span",{pre:!0,attrs:{class:"token constant"}},[s._v("DNS")]),s._v("缓存\n"),a("span",{pre:!0,attrs:{class:"token constant"}},[s._v("DNS")]),s._v("查询过程：\n  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("、首先搜索浏览器的"),a("span",{pre:!0,attrs:{class:"token constant"}},[s._v("DNS")]),s._v("缓存"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("如果存在，则域名解析完成。\n  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v("、如果浏览器缓存里面没有找到，那么会读取操作系统的hosts文件看是否存在对应的映射关系"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("如果存在，则域名解析完成。\n  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),s._v("、如果本地hosts文件不存在映射关系，则查找本地"),a("span",{pre:!0,attrs:{class:"token constant"}},[s._v("DNS")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("服务器")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token constant"}},[s._v("ISP")]),s._v("服务器"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("或者自己手动设置的"),a("span",{pre:!0,attrs:{class:"token constant"}},[s._v("DNS")]),s._v("服务器"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("如果存在"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("域名解析完成。\n  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("4")]),s._v("、如果本地"),a("span",{pre:!0,attrs:{class:"token constant"}},[s._v("DNS")]),s._v("服务器还没找到的话"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("它就会向根服务器发出请求"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("进行递归查询。\n\n清除操作系统"),a("span",{pre:!0,attrs:{class:"token constant"}},[s._v("DNS")]),s._v("缓存： 清除"),a("span",{pre:!0,attrs:{class:"token constant"}},[s._v("DNS")]),s._v("缓存的命令是ipconfig"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("flushdns。我们需要在显示的命令框中输入该命令。\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br")])]),a("h3",{attrs:{id:"_2、cdn-缓存"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2、cdn-缓存"}},[s._v("#")]),s._v(" 2、CDN 缓存")]),s._v(" "),a("div",{staticClass:"language-js line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token constant"}},[s._v("CDN")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" Content Delivery Network 内容分发网络\n\n"),a("span",{pre:!0,attrs:{class:"token constant"}},[s._v("CDN")]),s._v("资源请求过程：\n  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("、浏览器向"),a("span",{pre:!0,attrs:{class:"token constant"}},[s._v("CDN")]),s._v("节点请求数据，"),a("span",{pre:!0,attrs:{class:"token constant"}},[s._v("CDN")]),s._v("节点会判断缓存数据是否过期，若缓存数据并没有过期，则直接将缓存数据返回给客户端；\n  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v("、否则，"),a("span",{pre:!0,attrs:{class:"token constant"}},[s._v("CDN")]),s._v("节点就会向服务器发出回源请求，从服务器拉取最新数据，更新本地缓存，并将最新数据返回给客户端\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br")])]),a("h3",{attrs:{id:"_3、http-缓存"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_3、http-缓存"}},[s._v("#")]),s._v(" 3、HTTP 缓存")]),s._v(" "),a("p",[a("a",{attrs:{href:"https://www.jianshu.com/p/54cc04190252",target:"_blank",rel:"noopener noreferrer"}},[s._v("参考"),a("OutboundLink")],1)]),s._v(" "),a("p",[a("img",{attrs:{src:"/images/%E7%BC%93%E5%AD%98.png",alt:"HTTP缓存"}})]),s._v(" "),a("details",{staticClass:"custom-block details"},[a("summary",[s._v("点击查看")]),s._v(" "),a("h3",{attrs:{id:"一、缓存位置"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#一、缓存位置"}},[s._v("#")]),s._v(" 一、缓存位置")]),s._v(" "),a("p",[s._v("1、Memory Cache：内存缓存"),a("br"),s._v("\n2、Disk Cache：硬盘中的缓存")]),s._v(" "),a("p",[a("code",[s._v("Memory Cache")]),s._v("\n主要缓存当前中页面中已经抓取到的资源,例如页面上已经下载的样式、脚本、图片等。"),a("br"),s._v("\n读取内存中的数据比磁盘快,内存缓存虽然读取高效，但是内存比较小，并且缓存持续性很短，会随着进程的释放而释放。"),a("br"),s._v("\n一旦我们关闭 Tab 页面，内存中的缓存也就被释放了。")]),s._v(" "),a("p",[s._v("内存缓存中有一块重要的缓存资源是 preloader 相关指令（例如"),a("code",[s._v('<link rel="prefetch">')]),s._v("）下载的资源")]),s._v(" "),a("p",[a("code",[s._v("Disk Cache")]),s._v("\n一般非脚本会存在内存当中，如 css ，或者是大文件\nDisk Cache 也就是存储在硬盘中的缓存，读取速度慢点，但是什么都能存储到磁盘中，比之 Memory Cache 胜在容量和存储时效性上。"),a("br"),s._v("\n退出进程时数据不会被清除")]),s._v(" "),a("ul",[a("li",[a("p",[s._v("缓存之后--读取缓存规则：")]),s._v(" "),a("ul",[a("li",[s._v("1、再次地址栏输入地址：状态码 200 (from disk cache)")]),s._v(" "),a("li",[s._v("2、F5 刷新：状态码 200 (form memory cache)")]),s._v(" "),a("li",[s._v("3、ctrl + F5 强制刷新：重新从服务器下载资源")])])]),s._v(" "),a("li",[a("p",[s._v("三级缓存原理 (访问缓存优先级):")]),s._v(" "),a("ul",[a("li",[s._v("1、先在内存中查找,如果有,直接加载。")]),s._v(" "),a("li",[s._v("2、如果内存中不存在,则在硬盘中查找,如果有直接加载。")]),s._v(" "),a("li",[s._v("3、如果硬盘中也没有,那么就进行网络请求。")]),s._v(" "),a("li",[s._v("4、请求获取的资源缓存到硬盘和内存")])])])]),s._v(" "),a("h3",{attrs:{id:"二、http-缓存的分类"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#二、http-缓存的分类"}},[s._v("#")]),s._v(" 二、HTTP 缓存的分类")]),s._v(" "),a("p",[s._v("1、强缓存"),a("br"),s._v("\n2、协商缓存")]),s._v(" "),a("p",[s._v("优先级： 强缓存 > 协商缓存")]),s._v(" "),a("h3",{attrs:{id:"强缓存"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#强缓存"}},[s._v("#")]),s._v(" 强缓存")]),s._v(" "),a("p",[s._v("不会向服务器发送请求，直接从浏览器缓存中读取资源，请求成功，返回 200 from disk cache 或 from memory cache"),a("br"),s._v("\n控制强缓存的字段分别是"),a("code",[s._v("Expires")]),s._v("和"),a("code",[s._v("Cache-Control")]),a("br"),s._v("\n其中 Cache-Control 优先级比 Expires 高")]),s._v(" "),a("p",[a("code",[s._v("Expires")]),s._v(":"),a("br"),s._v("\n该字段是 http1.0 时的规范，它的值为是服务器端的绝对时间 GMT 格式的时间字符串，比如 Expires:Mon,18 Oct 2066 23:59:59 GMT。"),a("br"),s._v("\n这个时间代表着这个资源的失效时间 是一个绝对值\n再次请求，缓存会拿 Expires 的时间和客户端时间比较，在 Expires 时间之前，即命中缓存"),a("br"),s._v(" "),a("code",[s._v("存在问题")]),s._v("：客户端或者服务端时间不准; 客户端时间修改，也会出现问题")]),s._v(" "),a("p",[a("code",[s._v("Cache-Control")]),s._v(" http1.1 规范 属性值："),a("br"),s._v("\npublic: 所有内容都将被缓存（客户端，代理服务器都可以缓存）"),a("br"),s._v("\nprivate：所有内容，只有客户端可以缓存（默认值）"),a("br"),s._v("\nno-cache: 需要进行协商缓存，发送请求到服务器确认是否使用缓存"),a("br"),s._v("\nno-store: 禁止使用缓存，每次都需要重新发送请求数据"),a("br"),s._v("\nmax-age=3600: 单位 s 缓存将在 3600s 之后失效， 是一个相对值 （需配合 Last-modified 使用）"),a("br"),s._v("\n再次请求时，")]),s._v(" "),a("p",[s._v("强缓存判断是否缓存的依据来自于是否超出某个时间或者某个时间段，而不关心服务器端文件是否已经更新"),a("br"),s._v("\n这可能会导致加载文件不是服务器端最新的内容")]),s._v(" "),a("h3",{attrs:{id:"协商缓存"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#协商缓存"}},[s._v("#")]),s._v(" 协商缓存")]),s._v(" "),a("p",[s._v("当强缓存没有命中的时候，浏览器会发送一个请求到服务器，服务器根据 请求头 header 中的部分信息来判断是否命中缓存。"),a("br"),s._v("\n请求头 header 中的字段是 "),a("code",[s._v("Last-Modify和If-Modify-Since")]),s._v(" 和 "),a("code",[s._v("ETag和If-None-Match")]),s._v(". 其中 ETag 优先级较高"),a("br"),s._v("\n如果命中，则返回 304 Not Modified，告诉浏览器资源未更新，可使用本地的缓存，未命中，")]),s._v(" "),a("p",[a("code",[s._v("Last-Modify和If-Modify-Since")]),a("br"),s._v("\n浏览器第一次请求一个资源的时候，服务器返回的 响应头 header 中会加上 Last-Modify，Last-modify 是一个时间标识该资源的最后修改时间。"),a("br"),s._v("\n当浏览器再次请求该资源时，request 的请求头中会包含 If-Modify-Since，该值为缓存之前返回的 Last-Modify 值。"),a("br"),s._v("\n服务器收到 If-Modify-Since 后，对比资源的最后修改时间，判断是否命中缓存。"),a("br"),s._v("\n如果命中缓存，则返回 304，并且不会返回资源内容，并且不会返回 Last-Modify。 未命中， 返回新的资源文件和 200")]),s._v(" "),a("p",[a("code",[s._v("存在问题")]),a("br"),s._v("\n如果本地打开缓存文件，即使没有对文件进行修改，但还是会造成 Last-Modified 被修改，服务端不能命中缓存导致发送相同的资源"),a("br"),s._v("\n因为 Last-Modified 只能以秒计时，如果在不可感知的时间内修改完成文件，那么服务端会认为资源还是命中了，不会返回正确的资源")]),s._v(" "),a("p",[a("code",[s._v("ETag和If-None-Match")]),a("br"),s._v("\nETag 当前资源文件的一个唯一标识(由服务器生成)，资源变化都会导致 ETag 变化"),a("br"),s._v("\n再次请求时，会将上一次返回的 Etag 值放到请求头 header 里的 If-None-Match 里，服务器只需要比较传来的 If-None-Match 跟自己服务器上该资源的 ETag 是否一致，如果服务器发现 ETag 匹配不上，那么直接返回 200 并将将新的资源（当然也包括了新的 ETag）发给客户端；如果 ETag 是一致的，则直接返回 304，客户端直接使用本地缓存即可")])]),s._v(" "),a("h3",{attrs:{id:"_4、浏览器缓存"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_4、浏览器缓存"}},[s._v("#")]),s._v(" 4、浏览器缓存")]),s._v(" "),a("p",[s._v("最常用到的浏览器缓存有：cookie、sessionStorage、localStorage")]),s._v(" "),a("p",[a("img",{attrs:{src:"/images/%E6%B5%8F%E8%A7%88%E5%99%A8%E7%BC%93%E5%AD%98.png",alt:"浏览器缓存"}})]),s._v(" "),a("div",{staticClass:"language-js line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])])])}),[],!1,null,null,null);a.default=e.exports}}]);