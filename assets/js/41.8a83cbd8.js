(window.webpackJsonp=window.webpackJsonp||[]).push([[41],{465:function(s,t,a){"use strict";a.r(t);var e=a(1),n=Object(e.a)({},(function(){var s=this,t=s._self._c;return t("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[t("p",[t("a",{attrs:{href:"https://juejin.im/post/6844903842635579405",target:"_blank",rel:"noopener noreferrer"}},[s._v("转载"),t("OutboundLink")],1)]),s._v(" "),t("h2",{attrs:{id:"一、xss-cross-site-scripting-跨站脚本攻击"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#一、xss-cross-site-scripting-跨站脚本攻击"}},[s._v("#")]),s._v(" 一、XSS (cross-site-scripting) 跨站脚本攻击")]),s._v(" "),t("p",[s._v("XSS: 是一种代码注入攻击，通过在目标网站上注入恶意脚本，使其在浏览器中运行。"),t("br"),s._v("\n利用这些脚本可以获取 cookie,session 等，危害数据安全")]),s._v(" "),t("ul",[t("li",[s._v("XSS 分类：\n"),t("ul",[t("li",[s._v("1、反射型： 通过 URL")]),s._v(" "),t("li",[s._v("2、DOM 型： 通过数据库存储，前端存储，URL")]),s._v(" "),t("li",[s._v("3、存储型： 存储在数据库")])])])]),s._v(" "),t("h3",{attrs:{id:"_1、反射型"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_1、反射型"}},[s._v("#")]),s._v(" 1、反射型")]),s._v(" "),t("p",[s._v("什么是反射型 XSS 攻击？"),t("br"),s._v("\n当用户点击一个恶意链接，或者提交一个表单，或者进入一个恶意网站时，注入脚本进入被攻击者的网站。"),t("br"),s._v("\nWeb 服务器将注入脚本，比如一个错误信息，搜索结果等，未进行过滤直接返回到用户的浏览器地址上，脚本就会执行")]),s._v(" "),t("p",[s._v("触发方式？"),t("br"),s._v("\n反射型 XSS 漏洞常见于通过 URL 传递参数的功能，如网站搜索、跳转等。"),t("br"),s._v("\n由于需要用户主动打开恶意的 URL 才能生效，攻击者往往会结合多种手段诱导用户点击。\nPOST 的内容也可以触发反射型 XSS，触发条件比较苛刻（需要构造表单提交页面，并引导用户点击）")]),s._v(" "),t("p",[s._v("如何防范？"),t("br"),s._v("\n1、对 url 参数进行编码：encodeURIComponent(req.data)")]),s._v(" "),t("h3",{attrs:{id:"_2、dom-型"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_2、dom-型"}},[s._v("#")]),s._v(" 2、DOM 型")]),s._v(" "),t("p",[s._v("DOM 型 XSS 攻击："),t("br"),s._v("\n就是前端 JavaScript 代码不够严谨，把不可信的内容插入到了页面。(使用 .innerHTML、.outerHTML、.appendChild、document.write())")]),s._v(" "),t("p",[s._v("触发："),t("br"),s._v("\n攻击者构造出特殊数据，其中包含恶意代码。用户浏览器执行了恶意代码。"),t("br"),s._v("\n恶意代码窃取用户数据并发送到攻击者的网站，或者冒充用户的行为，调用目标网站接口执行攻击者指定的操作")]),s._v(" "),t("p",[s._v("防范："),t("br"),s._v("\n1、url 链接(例如图片的 src 属性)，那么直接使用 encodeURIComponent 来转义。"),t("br"),s._v("\n2、非 url，进行编码替换")]),s._v(" "),t("div",{staticClass:"language-js line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-js"}},[t("code",[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("function")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("encodeHtml")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token parameter"}},[s._v("str")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("return")]),s._v(" str\n    "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("replace")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token regex"}},[t("span",{pre:!0,attrs:{class:"token regex-delimiter"}},[s._v("/")]),t("span",{pre:!0,attrs:{class:"token regex-source language-regex"}},[s._v('"')]),t("span",{pre:!0,attrs:{class:"token regex-delimiter"}},[s._v("/")]),t("span",{pre:!0,attrs:{class:"token regex-flags"}},[s._v("g")])]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"&quot;"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("replace")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token regex"}},[t("span",{pre:!0,attrs:{class:"token regex-delimiter"}},[s._v("/")]),t("span",{pre:!0,attrs:{class:"token regex-source language-regex"}},[s._v("'")]),t("span",{pre:!0,attrs:{class:"token regex-delimiter"}},[s._v("/")]),t("span",{pre:!0,attrs:{class:"token regex-flags"}},[s._v("g")])]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"&apos;"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("replace")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token regex"}},[t("span",{pre:!0,attrs:{class:"token regex-delimiter"}},[s._v("/")]),t("span",{pre:!0,attrs:{class:"token regex-source language-regex"}},[s._v("<")]),t("span",{pre:!0,attrs:{class:"token regex-delimiter"}},[s._v("/")]),t("span",{pre:!0,attrs:{class:"token regex-flags"}},[s._v("g")])]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"&lt;"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("replace")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token regex"}},[t("span",{pre:!0,attrs:{class:"token regex-delimiter"}},[s._v("/")]),t("span",{pre:!0,attrs:{class:"token regex-source language-regex"}},[s._v(">")]),t("span",{pre:!0,attrs:{class:"token regex-delimiter"}},[s._v("/")]),t("span",{pre:!0,attrs:{class:"token regex-flags"}},[s._v("g")])]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"&gt;"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br")])]),t("h3",{attrs:{id:"_3、存储型"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_3、存储型"}},[s._v("#")]),s._v(" 3、存储型")]),s._v(" "),t("p",[s._v("恶意脚本永久存储在目标服务器上。当浏览器请求数据时，脚本从服务器传回并执行，影响范围比反射型和 DOM 型 XSS 更大。\n存储型 XSS 攻击的原因仍然是没有做好数据过滤：前端提交数据至服务端时，没有做好过滤；服务端在接受到数据时，在存储之前，没有做过滤；前端从服务端请求到数据，没有过滤输出。")]),s._v(" "),t("p",[s._v("防范："),t("br"),s._v("\n1、各个环节，对数据进行转义"),t("br"),s._v("\n2、输入内容进行过滤"),t("br"),s._v("\n3、输入长度进行限制")]),s._v(" "),t("h2",{attrs:{id:"二、csrf-cross-site-request-forgery-跨站请求伪造"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#二、csrf-cross-site-request-forgery-跨站请求伪造"}},[s._v("#")]),s._v(" 二、CSRF (cross-site request forgery) 跨站请求伪造")]),s._v(" "),t("p",[s._v("攻击者诱导用户进入第三方网站，在第三方网站中，向被攻击网站发送跨站请求。"),t("br"),s._v("\n利用用户在被攻击网站已经获取的注册凭证，绕过后台的用户验证，达到冒充用户对被攻击的网站执行某项操作的目的\n（CSRF 攻击是攻击者借助受害者的 Cookie 骗取服务器的信任，在受害者毫不知情的情况下以受害者名义伪造请求发送给受攻击服务器，从而在并未授权的情况下执行在权限保护之下的操作）")]),s._v(" "),t("p",[s._v("跨站请求可以用各种方式：图片 URL、超链接、CORS、Form 提交等等(来源不明的链接，不要点击)")]),s._v(" "),t("p",[s._v("防范："),t("br"),s._v("\n1、关键操作添加验证码方式"),t("br"),s._v("\n2、判断请求的来源：检测 Referer(但是并不安全，Referer 可以被更改)"),t("br"),s._v("\n3、使用 Token(主流)")]),s._v(" "),t("h2",{attrs:{id:"三、点击劫持"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#三、点击劫持"}},[s._v("#")]),s._v(" 三、点击劫持")]),s._v(" "),t("p",[s._v("点击劫持是指在一个 Web 页面中隐藏了一个透明的 iframe，用外层假页面诱导用户点击，"),t("br"),s._v("\n实际上是在隐藏的 frame 上触发了点击事件进行一些用户不知情的操作")]),s._v(" "),t("p",[s._v("防范："),t("br"),s._v("\n1、frame busting"),t("br"),s._v("\nHTML5 中 iframe 的 sandbox 属性、IE 中 iframe 的 security 属性等，都可以限制 iframe 页面中的 JavaScript 脚本执行，从而可以使得 frame busting 失效")]),s._v(" "),t("div",{staticClass:"language-js line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-js"}},[t("code",[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("top"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("location "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("!=")]),s._v(" window"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("location"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  top"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("location "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" window"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("location"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br")])]),t("p",[s._v("2、X-Frame-Options"),t("br"),s._v("\nX-FRAME-OPTIONS 是微软提出的一个 http 头，专门用来防御利用 iframe 嵌套的点击劫持攻击")]),s._v(" "),t("ul",[t("li",[s._v("属性值：\n"),t("ul",[t("li",[s._v("DENY: 拒绝任何域加载")]),s._v(" "),t("li",[s._v("SAMEORIGIN: 允许同源域下加载")]),s._v(" "),t("li",[s._v("ALLOW-FROM: 可以定义允许 frame 加载的页面地址")])])])])])}),[],!1,null,null,null);t.default=n.exports}}]);